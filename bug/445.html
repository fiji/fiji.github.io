<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 445 &ndash; Library.txt is not being loaded</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="">

  


  
    
      

      
      



    
    <link href="../css/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="../css/global.css" rel="stylesheet"
        type="text/css" ><link href="../css/bug.css" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1492730519" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="../css/dusk.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    


    


    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class=" bz_bug bz_status_RESOLVED bz_product_Fiji bz_component_Other bz_bug_445 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;445</p>
    </td>

    <td id="subtitle">
      <p class="subheader">Library.txt is not being loaded</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2015-04-07 07:41:11 CDT</p>
    </td>
</tr>
</table>


</div> 

<div id="bugzilla-body">


<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2015-04-07 07:41:11">
  <input type="hidden" name="longdesclength" value="9">
  <input type="hidden" name="id" value="445">
  <input type="hidden" name="token" value="1492731645-6q0lRUz0C4aLSlI5IkIBkj-9V5-in3i9U39Ckc7G4jM">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=445"><b>Bug&nbsp;445</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Library.txt is not being loaded</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>Library.txt is not being loaded
          </td>
        </tr>
      </table>
    </div>
  </div>
  
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Fiji</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Fiji"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Other</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">Macintosh
       Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P2
       normal
      </td>
    </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">ImageJ Bugs Mailing List</span>
</span>
      </td>
    </tr>

    
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2012-07-02 21:28 CDT by <span class="vcard"><span class="fn">Carnë Draug</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2015-04-07 07:41 CDT 
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>3 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="christian.evenhuis">christian.evenhuis</option>
                <option value="ctrueden">ctrueden</option>
                <option value="johannes.schindelin">johannes.schindelin</option>
            </select>
        </div>
          
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    



  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments">






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Carnë Draug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-02 21:28:08 CDT
        </span>
      </div>



<pre class="bz_comment_text" >The file Library.txt is not being loaded at all. When I write a macro that uses one of its functions, I get the error &quot;Undefined identifier&quot; for the functions defined on Library.txt

I have tested this with the FIJI version on the Debian repositories (Debian squeeze with ImageJA 1.45i) and with the FIJI for linux available for download (ImageJA 1.45b).

I have checked the value of &quot;Menus.getMacrosPath&quot; and placed the Library.txt file on the correct place. I have both write and read permissions for the file (I even tried chmod 777).</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-09-18 20:33:42 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Should that not be macros/FunctionLibrary.txt?</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Carnë Draug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-09-19 00:37:07 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Not according to the manual. The ImageJ Macro Language Programmer’s Reference Guide v1.46d states on page 16:

&quot;However, those functions that you want to be available from all macros can be included in special macro that is appended to any executed macro. This special macro must be available from the following location: ImageJ/macros/Library.txt .

In short, the ImageJ/macros/Library.txt macro is appended to any executed or installed macro.&quot;


I have reported this first on the ImageJ mailing list

<a href="http://imagej.1557.n6.nabble.com/Library-txt-is-not-being-loaded-td4999246.html">http://imagej.1557.n6.nabble.com/Library-txt-is-not-being-loaded-td4999246.html</a>

and was told the same. At the time I tried to use that name but didn't fix it.</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Carnë Draug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-10-12 02:09:03 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi

I can confirm that this bug is exclusive to FIJI. I have just download ImageJ on its own (1.47d), and Library.txt is loaded just fine. On this version of ImageJ I tried to rename Library.txt to FunctionLibrary.txt which made it fail so indeed Library.txt is the right name.

I have also tried to use FIJI with ImageJ 1.47d (not ImageJA) but that also does not fix the bug. This further suggests that the bug is somewhere in the FIJI project.

Carnë</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 19:26:38 CDT
        </span>
      </div>



<pre class="bz_comment_text" >This bug severely limits the usefulness of macro scripting.  

I am certain that being able to maintain a reusable set of macro functions would make life a lot easy for many users.

Chris</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Curtis Rueden</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 21:41:52 CDT
        </span>
      </div>



<pre class="bz_comment_text" >I cannot reproduce this problem with an up-to-date Fiji on OS X 10.10.

I created the file /Applications/Fiji.app/macros/Library.txt and put the following contents:

 function hello() {
   showMessage(&quot;Hello world&quot;, &quot;How's it going today?&quot;);
 }

I then started Fiji, pressed [ for the Script Editor, changed the Language to IJ1 Macro, and typed the following macro:

 hello();

Pressed Cmd+R to run, and it displayed the dialog as desired.

Can you please provide a more specific recipe to reproduce?</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-25 00:45:48 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi Curtis,

thanks for the quick the reply.

After playing around I think the problem is that I need to update the loaded macros after any changes are made to the Library.txt file.  I’ve found that “Help &gt; Refresh Menus” does the trick.  

It seems that this can't be called from a macro, probably for good reasons.  Is there way to avoid manual refreshing?  

What I want to do is for my macro to update the helper functions by cat’ing all the *.ijm files some directory to Library.txt, refresh the macro list, then be able to user the function from Library.txt.  

Thanks,

Chris</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Curtis Rueden</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-04-06 17:19:42 CDT
        </span>
      </div>



<pre class="bz_comment_text" >I am closing this bug, since the description is &quot;Library.txt is not being loaded&quot; and it seems that it is now, in fact, being loaded as expected. A step forward. ;-)

Chris wrote:
<span class="quote">&gt; It seems that this can't be called from a macro, probably for good reasons.
&gt; Is there way to avoid manual refreshing?  </span >

Well, I think it can be called from a macro. It just shows that popup dialog box now. We added that on purpose so that people are aware that &quot;Refresh Menus&quot; doesn't do a complete job of actually refreshing the menus anymore. But perhaps we should not show that message in macro mode...

Chris wrote:
<span class="quote">&gt; What I want to do is for my macro to update the helper functions by
&gt; cat’ing all the *.ijm files some directory to Library.txt, refresh
&gt; the macro list, then be able to user the function from Library.txt.  </span >

I'd like to understand your use case. Do you require this sort of dynamic updating without restarting ImageJ? Or would it be enough for your Library.txt to use a trick similar to:

<a href="https://github.com/fiji/fiji/blob/86622adda86e786dac01e8f7339cba5cb772b50b/macros/StartupMacros.fiji.ijm#L49-L60">https://github.com/fiji/fiji/blob/86622adda86e786dac01e8f7339cba5cb772b50b/macros/StartupMacros.fiji.ijm#L49-L60</a>

?</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Carnë Draug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-04-07 07:41:11 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Curtis Rueden wrote on <a href="#c7">comment #7</a>
<span class="quote">&gt; I am closing this bug, since the description is &quot;Library.txt is not being loaded&quot; and it seems that it is now, in fact, being loaded as expected. A step forward. ;-)</span >

Yes, I confirm I can no longer reproduce this bug with latest update of FIJI. Thank you</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>


</div>

</body>
</html>
