<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 951 &ndash; load(path) does work in javascript, but not if called from a macro</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=951&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=951">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=951">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=951">



    
    <link href="../css/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="../css/global.css" rel="stylesheet"
        type="text/css" ><link href="../css/bug.css" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1492730519" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="../css/dusk.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    


    


    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class=" bz_bug bz_status_RESOLVED bz_product_Fiji bz_component_Plugins bz_bug_951 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;951</p>
    </td>

    <td id="subtitle">
      <p class="subheader">load(path) does work in javascript, but not if called from a macro</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2014-11-01 17:33:20 CDT</p>
    </td>
</tr>
</table>


</div> 

<div id="bugzilla-body">


<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-11-01 17:33:20">
  <input type="hidden" name="longdesclength" value="2">
  <input type="hidden" name="id" value="951">
  <input type="hidden" name="token" value="1492731859-OrezW2TsCx5cxQQy3tsR9RoiASBC3dkutS1zm1eYY74">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=951"><b>Bug&nbsp;951</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">load(path) does work in javascript, but not if called from a macro</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>load(path) does work in javascript, but not if called from a macro
          </td>
        </tr>
      </table>
    </div>
  </div>
  
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Fiji</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Fiji"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Plugins</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">Macintosh
       Mac OS
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P4
       normal
      </td>
    </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">ImageJ Bugs Mailing List</span>
</span>
      </td>
    </tr>

    
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2014-11-01 02:56 CDT by <span class="vcard"><span class="fn">Christophe Leterrier</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2014-11-01 17:33 CDT 
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>2 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="christophe.leterrier">christophe.leterrier</option>
                <option value="wsr">wsr</option>
            </select>
        </div>
          
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    



  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments">






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=951#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Christophe Leterrier</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-01 02:56:39 CDT
        </span>
      </div>



<pre class="bz_comment_text" >I have a script (javascript) that calls functions in another script using load(path). It works fine in Fiji thanks to Johannes' work (see <a href="http://imagej.1557.x6.nabble.com/Javascript-in-Fiji-does-not-work-anymore-td5008314.html">http://imagej.1557.x6.nabble.com/Javascript-in-Fiji-does-not-work-anymore-td5008314.html</a>).

I have now made a toolset to launch these various scripts using the runMacro(path) command. So what happens is that the Action Tool calls the script#1 using runMacro(path1), and the script#1 calls functions in script#2 using load(path2). However when I do this, I get an error (that does not happen when launching script#1 directly:

ReferenceError: &quot;load&quot; is not defined (&lt;Unknown source&gt;#35) in &lt;Unknown source&gt; at line number 35

Anyone knows what happens here, and knows how to work around/correct this?

Information about your version of Java:

  os.arch =&gt; x86_64
  os.name =&gt; Mac OS X
  os.version =&gt; 10.10
  java.version =&gt; 1.6.0_65
  java.vendor =&gt; Apple Inc.
  java.runtime.name =&gt; Java(TM) SE Runtime Environment
  java.runtime.version =&gt; 1.6.0_65-b14-466.1-11M4716
  java.vm.name =&gt; Java HotSpot(TM) 64-Bit Server VM
  java.vm.version =&gt; 20.65-b04-466.1
  java.vm.vendor =&gt; Apple Inc.
  java.vm.info =&gt; mixed mode
  java.awt.graphicsenv =&gt; apple.awt.CGraphicsEnvironment
  java.specification.name =&gt; Java Platform API Specification
  java.specification.version =&gt; 1.6
  sun.cpu.endian =&gt; little
  sun.desktop =&gt; null
  file.separator =&gt; /

The up-to-date check says: UP_TO_DATE

Information relevant to JAVA_HOME related problems:

  JAVA_HOME is set to: null
  imagej.dir =&gt; /Users/christo/Travail/Labo/Processing/Fiji_current/Fiji.app

Information about the version of each plugin:

Activated update sites:
ImageJ: <a href="http://update.imagej.net/">http://update.imagej.net/</a> (last check:20141026020028)
Fiji: <a href="http://fiji.sc/update/">http://fiji.sc/update/</a> (last check:20141023165357)
Bio-Formats: <a href="http://sites.imagej.net/Bio-Formats/">http://sites.imagej.net/Bio-Formats/</a> (last check:20141031022635)
GDSC-SMLM: <a href="http://sites.imagej.net/GDSC-SMLM/">http://sites.imagej.net/GDSC-SMLM/</a> (last check:20140918121334)
PTBIOP: <a href="http://biop.epfl.ch/Fiji-Update/">http://biop.epfl.ch/Fiji-Update/</a> (last check:20141008175041)

Files not up-to-date:
  200a30ac (MODIFIED) 20141001201752 Contents/Info.plist
  ebd9888a (MODIFIED) 20130910230945 macros/StartupMacros.fiji.ijm
  37d3408d (LOCAL_ONLY) 20130910230945 macros/StartupMacros.fiji_stock.ijm
  09d47feb (LOCAL_ONLY) 20141031212500 macros/myTool.txt
  1e948734 (LOCAL_ONLY) 20140423133536 macros/toolsets/3D_AIS_Measure.ijm
  dca2b75a (LOCAL_ONLY) 20121116182554 macros/toolsets/Intensity Ratios Tools.ijm
  d28c5f20 (LOCAL_ONLY) 20140331210831 macros/toolsets/PeakFinder_Tool.txt
  bc0b4a55 (LOCAL_ONLY) 20141031212500 macros/toolsets/SR tools.ijm
  e9cc69cf (LOCAL_ONLY) 20140116225135 macros/toolsets/Simple AIS Measure Tools.ijm
  491f95aa (LOCAL_ONLY) 20120531234749 macros/toolsets/Test_Shortcut.ijm
  074f1336 (LOCAL_ONLY) 20141029214914 plugins/Thunder_STORM.jar
  a9b2a6a9 (LOCAL_ONLY) 20141029214915 plugins/added SR/Batch_NStoTS3D.js
  924368ed (LOCAL_ONLY) 20141029214915 plugins/added SR/Batch_TSAddZUnc.js
  4fc89b3a (LOCAL_ONLY) 20140624222024 plugins/added SR/F-NStxtSplit.js
  0f5a18da (LOCAL_ONLY) 20141029214915 plugins/added SR/F-NStxtTranslate.js
  2171ad06 (LOCAL_ONLY) 20141029214915 plugins/added SR/F-TSAddZUnc.js
  8ad1cd33 (LOCAL_ONLY) 20141031212539 plugins/added SR/F-TSRotate.js
  8499ed11 (LOCAL_ONLY) 20141031212500 plugins/added SR/Generate_Recon.ijm
  85c74b0c (LOCAL_ONLY) 20141029214915 plugins/added SR/Generate_Recon_WIP.ijm
  d2fc2b14 (LOCAL_ONLY) 20141031212500 plugins/added SR/Generate_Slices from ROI.ijm
  79aa4406 (LOCAL_ONLY) 20141029223923 plugins/added SR/Generate_Slices from ROI_WIP.ijm
  d53b30fb (LOCAL_ONLY) 20141029214915 plugins/added SR/Get_Z_Range.js
  5ee9ebf4 (LOCAL_ONLY) 20140624222024 plugins/added SR/Single_NStxtSplit.js
  a0dba650 (LOCAL_ONLY) 20141029214915 plugins/added SR/Single_NStxtTranslate.js
  4f618b33 (LOCAL_ONLY) 20141029214915 plugins/added SR/Single_TSAddZUnc.js
  e6ea9222 (LOCAL_ONLY) 20141029214915 plugins/added SR/Single_TSRotate.js
  3dc946f2 (LOCAL_ONLY) 20141029214915 plugins/added SR/Slice_to_Zoombox.ijm
  f58c5b2e (LOCAL_ONLY) 20131105141630 plugins/added macros/Calculate_Ratios.ijm
  c73c63d4 (LOCAL_ONLY) 20120203190735 plugins/added macros/Calib_EMGain.ijm
  23565f48 (LOCAL_ONLY) 20120123170343 plugins/added macros/Convert_Image_to_Icon.ijm
  cf56c63a (LOCAL_ONLY) 20140624224104 plugins/added macros/Convert_NDF_to_ROI_monoCh.ijm
  9121b3d6 (LOCAL_ONLY) 20140624231653 plugins/added macros/Convert_NDF_to_ROI_monoCh_2.ijm
  8c162fbc (LOCAL_ONLY) 20121116182556 plugins/added macros/Convert_NDF_to_ROI_multiCh.ijm
  b73d84c3 (LOCAL_ONLY) 20140624231839 plugins/added macros/Convert_NDF_to_ROI_multiCh2.ijm
  5759d835 (LOCAL_ONLY) 20140306191916 plugins/added macros/Correct_&amp;_Split_Channels.ijm
  1e1afbf4 (LOCAL_ONLY) 20140517214448 plugins/added macros/Duplicate_wLabel.ijm
  6a5e9f21 (LOCAL_ONLY) 20120120190326 plugins/added macros/Edit_Cat_ROIs.ijm
  d0ae64a9 (LOCAL_ONLY) 20120523184024 plugins/added macros/Extract_LIF.ijm
  681f02d5 (LOCAL_ONLY) 20140423133537 plugins/added macros/Extract_Zeiss.ijm
  fa330291 (LOCAL_ONLY) 20130530200036 plugins/added macros/Generate_Comets.ijm
  b4baa60d (LOCAL_ONLY) 20130908215841 plugins/added macros/Generate_Kymos.ijm
  40277102 (LOCAL_ONLY) 20140624222024 plugins/added macros/Generate_Stacks_Folder.ijm
  d4e49dd3 (LOCAL_ONLY) 20121116182556 plugins/added macros/Generate_Tracings_Folder_monoCh.ijm
  664cbbe3 (LOCAL_ONLY) 20121116182556 plugins/added macros/Generate_Tracings_Folder_multiCh.ijm
  aa4dfffd (LOCAL_ONLY) 20140211211257 plugins/added macros/Make_Projections.ijm
  6b42d1ed (LOCAL_ONLY) 20120203190735 plugins/added macros/Mean_vs_SD.ijm
  9ecf1256 (LOCAL_ONLY) 20130410220303 plugins/added macros/Measure_Intensities.ijm
  ec2b207d (LOCAL_ONLY) 20120120190326 plugins/added macros/Normalize_Movie.ijm
  44725a89 (LOCAL_ONLY) 20120120190326 plugins/added macros/Pad_Image_to_Stack.ijm
  848b3f14 (LOCAL_ONLY) 20140201140529 plugins/added macros/Plot_Column.ijm
  cf33bc89 (LOCAL_ONLY) 20130419214758 plugins/added macros/RGB_Profiles_Tool.ijm
  a04dd29d (LOCAL_ONLY) 20120120190326 plugins/added macros/Register_Coverslip_Zeiss.ijm
  464c88ea (LOCAL_ONLY) 20120120190326 plugins/added macros/Running_Average.ijm
  7eec215c (LOCAL_ONLY) 20120928172722 plugins/added macros/Simple_AIS_Measure.ijm
  61572565 (LOCAL_ONLY) 20130506225216 plugins/added macros/Simple_AIS_Measure_new.ijm
  d3faf6a6 (LOCAL_ONLY) 20120120190326 plugins/added macros/Stitch_Processed_Mosaic.ijm
  4a24763e (LOCAL_ONLY) 20120120190326 plugins/added macros/Transfer_Labels.ijm
  3e4083ae (LOCAL_ONLY) 20140829213750 plugins/added plugins/Actin2_Quantifier.class
  ac3d73f5 (LOCAL_ONLY) 20130502205606 plugins/added plugins/Align_RGB_planes.jar
  0a5c1981 (LOCAL_ONLY) 20130419214758 plugins/added plugins/Color_Profiler.jar
  c60c5966 (LOCAL_ONLY) 20131115215344 plugins/added plugins/FIRE_plugin.jar
  66f0be96 (LOCAL_ONLY) 20120120190326 plugins/added plugins/Fast_Filters$1.class
  7b74cdd1 (LOCAL_ONLY) 20120120190326 plugins/added plugins/Fast_Filters.class
  e9e5c061 (LOCAL_ONLY) 20140129213842 plugins/added plugins/Image_Stabilizer.class
  1fd3d1a6 (LOCAL_ONLY) 20140219221145 plugins/added plugins/Image_Stabilizer_Log_Applier.class
  a7eaa6cb (LOCAL_ONLY) 20140929212023 plugins/added plugins/KymoResliceWide_.jar
  a5d02cb7 (LOCAL_ONLY) 20140929212023 plugins/added plugins/Kymo_graph1001.jar
  dad4b299 (LOCAL_ONLY) 20130731193228 plugins/added plugins/M2LE_Pipeline.jar
  f07dd15c (LOCAL_ONLY) 20120120190326 plugins/added plugins/NeuronJ_.jar
  2b0f8e5e (LOCAL_ONLY) 20130419214758 plugins/added plugins/Radial_Profile.jar
  15638c2e (LOCAL_ONLY) 20140331202439 plugins/added plugins/Radial_Profile_Angle_Ext.jar
  97813c51 (LOCAL_ONLY) 20130331152055 plugins/added plugins/Sigma_Filter_Plus.class
  be06fe59 (LOCAL_ONLY) 20140929212023 plugins/added plugins/action_bar202.jar
  b2afde18 (LOCAL_ONLY) 20130908215841 plugins/added plugins/cell_counter.jar
  5229937c (LOCAL_ONLY) 20120120190326 plugins/added plugins/mm_nd_and_roi_pack.jar
  8fa95c18 (LOCAL_ONLY) 20140916183646 plugins/added scripts/Fit_Sinus.js
  b9d874ac (LOCAL_ONLY) 20140926224157 plugins/added scripts/Pro_Feat_Fit.js
  8771821c (LOCAL_ONLY) 20140926224157 plugins/added scripts/Profile_AlignRef.js
  4f471c4a (LOCAL_ONLY) 20140926224157 plugins/added scripts/Reassign_ROIs_HS channels.js
  b5d7dea9 (LOCAL_ONLY) 20140926224157 plugins/added scripts/Reassign_ROIs_HS to S.js
  5dea0423 (LOCAL_ONLY) 20140619220039 plugins/added scripts/Remove_Background_Median.js
  ccc0dfcb (LOCAL_ONLY) 20140624222024 plugins/added scripts/SAM2_V2.js</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=951#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wayne Rasband</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-01 17:33:20 CDT
        </span>
      </div>



<pre class="bz_comment_text" >This bug is fixed in the ImageJ 1.49k6 daily build, or work around it by calling the script using run(&quot;script.js&quot;) instead of runMacro(&quot;/path/to/script.js&quot;). For run(&quot;script.js&quot;) to work, script.js must be located in the plugins folder or an immediate subfolder. The runMacro() macro function runs scripts using the ImageJ JavaScript interpreter, which did not support the load() function prior to v1.49k6.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>


</div>

</body>
</html>
