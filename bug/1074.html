<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 1074 &ndash; I could not compile the Versatile Wand plugin</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="">

  


  
    
      

      
      



    
    <link href="../css/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="../css/global.css" rel="stylesheet"
        type="text/css" ><link href="../css/bug.css" rel="stylesheet"
        type="text/css" >

    <link href="../css/dusk.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    


    


    

    
    
    
  </head>



  <body onload=""
        class=" bz_bug bz_status_CONFIRMED bz_product_Fiji bz_component_Plugins bz_bug_1074 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;1074</p>
    </td>

    <td id="subtitle">
      <p class="subheader">I could not compile the Versatile Wand plugin</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2015-09-19 22:33:53 CDT</p>
    </td>
</tr>
</table>


</div> 

<div id="bugzilla-body">


<form name="changeform" id="changeform" method="post" action="">

  <input type="hidden" name="delta_ts" value="2015-09-19 22:33:53">
  <input type="hidden" name="longdesclength" value="9">
  <input type="hidden" name="id" value="1074">
  <input type="hidden" name="token" value="1492731910-lbit6HO-WOoE6IFz_gyxjeuAKW3lVPUMrSBbqMR4T6E">
<div class="bz_alias_short_desc_container edit_form">
     <a href="1074.html"><b>Bug&nbsp;1074</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">I could not compile the Versatile Wand plugin</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
  >Summary:</a>
</label>
</th>
          <td>I could not compile the Versatile Wand plugin
          </td>
        </tr>
      </table>
    </div>
  </div>
  
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a>Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CONFIRMED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Fiji</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Plugins</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">Macintosh
       Mac OS
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a><u>I</u>mportance</a></label>:
      </th>
      <td>P4
       normal
      </td>
    </tr>            
          
          <tr>
      <th class="field_label">
        <a>Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">ImageJ Bugs Mailing List</span>
</span>
      </td>
    </tr>

    
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2015-05-21 23:51 CDT by <span class="vcard"><span class="fn">Avital Steinberg</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2015-09-19 22:33 CDT 
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>5 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="ctrueden">ctrueden</option>
                <option value="hinerm">hinerm</option>
                <option value="jrr1985">jrr1985</option>
                <option value="Steinbergavital">Steinbergavital</option>
                <option value="wsr">wsr</option>
            </select>
        </div>
          
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    



  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments">






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Avital Steinberg</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-21 23:51:05 CDT
        </span>
      </div>



<pre class="bz_comment_text" >I downloaded the versatile_wand.java file from:

 <a href="http://imagejdocu.tudor.lu/doku.php?id=plugin:segmentation:versatile_wand:start">http://imagejdocu.tudor.lu/doku.php?id=plugin:segmentation:versatile_wand:start</a>

changed its name to Versatile_Wand.java, put it in the plugins folder and tried to compile it. It did not form a .class file. The only way to run this plugin in Fiji was to compile it using ImageJ.

Information about your version of Java:

  os.arch =&gt; x86_64
  os.name =&gt; Mac OS X
  os.version =&gt; 10.9.5
  java.version =&gt; 1.6.0_65
  java.vendor =&gt; Apple Inc.
  java.runtime.name =&gt; Java(TM) SE Runtime Environment
  java.runtime.version =&gt; 1.6.0_65-b14-462-11M4609
  java.vm.name =&gt; Java HotSpot(TM) 64-Bit Server VM
  java.vm.version =&gt; 20.65-b04-462
  java.vm.vendor =&gt; Apple Inc.
  java.vm.info =&gt; mixed mode
  java.awt.graphicsenv =&gt; apple.awt.CGraphicsEnvironment
  java.specification.name =&gt; Java Platform API Specification
  java.specification.version =&gt; 1.6
  sun.cpu.endian =&gt; little
  sun.desktop =&gt; null
  file.separator =&gt; /

The up-to-date check says: REMIND_LATER

Information relevant to JAVA_HOME related problems:

  JAVA_HOME is set to: null
  imagej.dir =&gt; /Applications/Fiji.app

Information about the version of each plugin:

Activated update sites:
ImageJ: <a href="http://update.imagej.net/">http://update.imagej.net/</a> (last check:20150501134914)
Fiji: <a href="http://fiji.sc/update/">http://fiji.sc/update/</a> (last check:20150520024906)

Files not up-to-date:
  ed67c174 (LOCAL_ONLY) 20150522025708 plugins/Versatile_Wand.class</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wayne Rasband</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-22 10:59:19 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Using Java 1.6.0_65 on OS X 10.10.2, I can compile and run Versatile_Wand.java by clicking on &quot;Run&quot; in the Script Editor. I can then install the Versatile Wand as a tool by checking &quot;Install Tool&quot; in the dialog and clicking &quot;OK&quot;, but I get this error message

   Could not load class Versatile_Wand in line 6
   call(&quot;Versatile_Wand.setOptions&quot;);

when I attempt to open the Versatile Wand Options dialog by double clicking on the tool icon.

When I run the &quot;Versatile Wand&quot; command from the Plugins menu I get this error message in the &quot;Console&quot; window:

Compiling 1 file in   /var/folders/sj/hs9p4kxn1z9brlkf83ycm4qr0000gn/T/java898253394430329430
Note: /var/folders/sj/hs9p4kxn1z9brlkf83ycm4qr0000gn/T/java898253394430329430/src/main/java/Versatile_Wand.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.

Using Java jdk1.8.0_45.jdk on OS X 10.10.3, I get this error message when I open Versatile_Wand.java in the Script Editor and click &quot;Run&quot;:

Started Versatile_Wand.java at Fri May 22 11:21:30 EDT 2015
Compiling 1 file in /var/folders/sj/hs9p4kxn1z9brlkf83ycm4qr0000gn/T/java4428824321535213749
/var/folders/sj/hs9p4kxn1z9brlkf83ycm4qr0000gn/T/java4428824321535213749/src/main/java/Versatile_Wand.java:16: cannot access java.util.Hashtable
bad class file: ZipFileIndexFileObject[/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/util/Hashtable.class)]
class file has wrong version 52.0, should be 50.0
Please remove or make sure it appears in the correct subdirectory of the classpath.
import java.util.Hashtable;
                ^
org.scijava.minimaven.JavaCompiler$CompileError: Compile error: 1
	at org.scijava.minimaven.JavaCompiler.call(JavaCompiler.java:80)
	at org.scijava.minimaven.MavenProject.build(MavenProject.java:477)
	at org.scijava.minimaven.MavenProject.build(MavenProject.java:406)
	at org.scijava.minimaven.MavenProject.build(MavenProject.java:391)
	at org.scijava.plugins.scripting.java.JavaEngine.compile(JavaEngine.java:211)
	at org.scijava.plugins.scripting.java.JavaEngine.eval(JavaEngine.java:135)
	at org.scijava.plugins.scripting.java.JavaEngine.eval(JavaEngine.java:173)
	at org.scijava.script.ScriptModule.run(ScriptModule.java:175)
	at org.scijava.module.ModuleRunner.run(ModuleRunner.java:167)
	at org.scijava.module.ModuleRunner.call(ModuleRunner.java:126)
	at org.scijava.module.ModuleRunner.call(ModuleRunner.java:65)
	at org.scijava.thread.DefaultThreadService$2.call(DefaultThreadService.java:181)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
java.lang.NullPointerException
	at java.lang.Class.isAssignableFrom(Native Method)
	at org.scijava.plugins.scripting.java.CommandJavaRunner.supports(CommandJavaRunner.java:71)
	at org.scijava.plugins.scripting.java.CommandJavaRunner.supports(CommandJavaRunner.java:46)
	at org.scijava.plugins.scripting.java.DefaultJavaService.run(DefaultJavaService.java:60)
	at org.scijava.plugins.scripting.java.JavaEngine.eval(JavaEngine.java:136)
	at org.scijava.plugins.scripting.java.JavaEngine.eval(JavaEngine.java:173)
	at org.scijava.script.ScriptModule.run(ScriptModule.java:175)
	at org.scijava.module.ModuleRunner.run(ModuleRunner.java:167)
	at org.scijava.module.ModuleRunner.call(ModuleRunner.java:126)
	at org.scijava.module.ModuleRunner.call(ModuleRunner.java:65)
	at org.scijava.thread.DefaultThreadService$2.call(DefaultThreadService.java:181)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mark Hiner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-22 14:11:17 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Compiling in the Script Editor is currently broken with Java 8 by default. An explanation and workaround is discussed here: <a href="https://github.com/fiji/fiji/issues/119">https://github.com/fiji/fiji/issues/119</a></pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wayne Rasband</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-24 14:07:25 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Compiling in the Script Editor is also broken with Java 6. To reproduce:

1. Open the Script Editor.
2. Open Templates&gt;Java&gt;Plot Example.
3. Click &quot;Run&quot; and save on the Desktop (you are not allowed to save in Fiji.app/plugins).
4. The plugin runs and displays a window named &quot;Example plot&quot;.
5. Attempts to re-run, without re-compiling, fail because there is no &quot;Plot Example&quot; command in the Plugins menu or in the &quot;Command Finder&quot; dialog.
6. The macro command run(&quot;Plot Example&quot;) also fails, evan after restarting Fiji.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Curtis Rueden</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-26 09:05:09 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Thanks Wayne. But it seems like (mostly) intended behavior to me. When you click &quot;Run&quot; in the Script Editor, it compiles the Java code, saves a temporary class file, and runs it. It does not install the plugin anywhere in ImageJ's menus. So it's true that the only way to run the plugin again is to execute the Script Editor's &quot;Run&quot; function again, which will recompile the plugin (though there is a critical bug: <a href="https://github.com/scijava/scripting-java/issues/5">https://github.com/scijava/scripting-java/issues/5</a>).

Installing the compiled plugin into the menu structure would be a different operation. It seems this can be done with Plugins &gt; Install PlugIn..., although a restart of ImageJ is needed. But the behavior is not ideal right now; in particular, the Console window always shows &quot;Compiling 1 file in ...&quot; messages when the plugin is subsequently run.

I definitely agree that all of this should be improved. But to honest it is not something LOCI has time to work on any time soon -- we feel it is much more urgent to improve support for Java 7 and 8, fix behavior on the latest OS X versions, address other related launcher problems, etc. For ImageJ plugin development, there are already (IMO better) tools such as Eclipse and NetBeans.</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wayne Rasband</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-26 15:18:08 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Eclipse and NetBeans can be overwhelming to a scientist who wants to develop a simple plugin or who wants to install a plugin only available in source form. The Script Editor should have an Install command similar to the Plugins&gt;Compile and Run command, which no longer works in Fiji. Fiji's Plugins&gt;Install Plugin command is not the solution since the installed plugin appears to be compiled every time you run it.</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Curtis Rueden</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-26 17:09:06 CDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt; Eclipse and NetBeans can be overwhelming to a scientist who wants to develop a simple plugin</span >

I agree, but would also argue the scientist should not use Java if their goal is simplicity. Better to use one of the many other supported scripting languages such as Javascript, Jython or Groovy. These other languages require less boilerplate, and have fewer problems currently in the Script Editor.

<span class="quote">&gt; The Script Editor should have an Install command similar to the Plugins&gt;Compile and Run command, which no longer works in Fiji.</span >

Agreed.

<span class="quote">&gt; Fiji's Plugins&gt;Install Plugin command is not the solution since the installed plugin appears to be compiled every time you run it.</span >

Perhaps the behavior of that command can be improved and migrated into ImageJ2 core.

I filed an issue to track this feature request:
  <a href="https://github.com/imagej/imagej-ui-swing/issues/44">https://github.com/imagej/imagej-ui-swing/issues/44</a></pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">jrr1985
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-09-19 10:56:53 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Sorry, I am new to imagej. Has anyone figured this out? If so can someone post the plugin so I can install it? I appreciate it.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wayne Rasband</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-09-19 22:33:53 CDT
        </span>
      </div>



<pre class="bz_comment_text" >There is a version of the Versatile Wand Tool at

  <a href="http://wsr.imagej.net/plugins/Versatile_Wand_Tool.jar">http://wsr.imagej.net/plugins/Versatile_Wand_Tool.jar</a>

that works with Fiji.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>


</div>

</body>
</html>
